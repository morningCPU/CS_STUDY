# File类与IO流

## 1. java.io.File类的使用

### 1.1 概述
+ File能管理文件,但不能访问文件
+ 需要访问的话需要使用输入/输出流

### 1.2 构造器
+ public File(String pathname)
默认的当前路径在系统属性user.dir中存储
+ public File(String parent,String child)
以parent为父路径,child为子路径创建File对象
+ public File(File parent,String child)
根据一个父File对象和子文件路径创建File对象
+ 地址的写法
`D:\first\second`要写成如下的形式：
1. `D:\\first\\second`
2. `D"/first/second`
+ IDEA中的相对路径
main中的文件的相对路径是相对于当前工程
单元测试方法中的文件的相对路径是相对于当前module
+ 注意
`/abc` 和 `abc` 不一样

### 1.3 常用方法
**获取文件和目录基本信息**
+ public String getName()
+ public String getPath()
+ public String getAbsolutePath()
+ public String getCanonicalPath()
+ public File getAbsoluteFile()
+ public String getParent()
+ public long length()
+ public long lastModified() 获取最后一次的修改时间

**列出目录的下一级**
+ public String[] list() 子文件或目录名
+ public File[] listFiles() 子文件或目录
+ 过滤器
```java
File[] subFiles = srcFile.listFiles(new FilenameFilter() {
	@Override
	public boolean accept(File dir, String name) {
		return name.endsWith(".jpg");
	}
});
```

**重命名**
+ public boolean renameTO(File dest)

**判断**
+ public boolean exists()
+ public boolean isDirectory()
+ public boolean isFile()
+ public boolean canRead()
+ public boolean canWrite()
+ public boolean isHidden()

### 1.4 创建、删除
+ public boolean createNewFile()
+ public boolean mkdir()
+ public boolean mkdirs()
+ public boolean delete() 注意它不走回收站

***

## 2. IO流
### 2.1 流的分类
+ 按流向分
输入流: 以InputStream、Reader结尾
输出流: 以OutputStream、Writer结尾
+ 按操作数据单位分
字节流: 以InputStream、OutputStreamr结尾
字符流: 以Reade、Writer结尾
+ 按IO流的角色分
节点流
处理流

### 2.2 流的API
| (抽象基类) |   输入流    |    输出流    |
| :--------: | :---------: | :----------: |
|   字节流   | InputStream | OutputStream |
|   字符流   |   Reader    |    Writer    |

+ 派生

|    分类    |      字节输入流      |      字节输出流       |    字符输入流     |     字符输出流     |
| :--------: | :------------------: | :-------------------: | :---------------: | :----------------: |
|  抽象基类  |     InputStream      |     OutputStream      |      Reader       |       Writer       |
|  访问文件  |   FileInputStream    |   FileOutputStream    |    FileReader     |     FileWriter     |
|  访问数组  | ByteArrayInputStream | ByteArrayOutputStream |  CharArrayReader  |  CharArrayWriter   |
|  访问管道  |   PipedInputStream   |   PipedOutputStream   |    PipedReader    |    PipedWriter     |
| 访问字符串 |                      |                       |   StringReader    |    StringWriter    |
|   缓冲流   | BufferedInputStream  | BufferedOutputStream  |  BufferedReader   |   BufferedWriter   |
|   转换流   |                      |                       | InputStreamReader | OutputStreamWriter |
|   对象流   |  ObjectInputStream   |  ObjectOutputStream   |                   |                    |
|            |  FilterInputStream   |  FilterOutputStream   |   FilterReader    |    FilterWriter    |
|   打印流   |                      |      PrintStream      |                   |    PrintWriter     |
| 推回输入流 | PushbackInputStream  |                       |  PushbackReader   |                    |
|   特殊流   |   DataInputStream    |   DataOutputStream    |                   |                    |

### 2.3 常用的节点流
+ 文件流
FileInputStream,FileOutputStream,FileReader,FileWriter
+ 数组
ByteArrayInputStream,ByteArrayOutputStream,CharArrayReader,CharArrayWriter

### 2.4 常用处理流
+ 缓冲流
BufferedInputStream,BufferedOutputStream,BufferedReader,BufferedWriter
作用：增加缓冲功能，避免频繁读写硬盘，进而提升读写效率
+ 转换流
InputStreamReader,OutputStreamWriter
实现字节流和字符流之间的转换
+ 对象流
ObjectInputStream,ObjectOutputStream

***

## 3. FileReader/FileWriter
### 3.1 Reader
+ public int read()
从输入流读取一个字符。 虽然读取了一个字符，但是会自动提升为int类型。返回该字符的Unicode编码值。如果已经到达流末尾了，则返回-1
+ public int read(char[] cbuf)
从输入流中读取一些字符，并将它们存储到字符数组 cbuf中 。每次最多读取cbuf.length个字符。返回实际读取的字符个数。如果已经到达流末尾，没有数据可读，则返回-1。 
+ public int read(char[] cbuf,int off,int len)
从输入流中读取一些字符，并将它们存储到字符数组 cbuf中，从cbuf[off]开始的位置存储。每次最多读取len个字符。返回实际读取的字符个数。如果已经到达流末尾，没有数据可读，则返回-1。 
+ public void close()
关闭此流并释放与此流相关联的任何系统资源
当完成流的操作时，必须调用close()方法，释放系统资源，否则会造成内存泄漏

### 3.2 Writer
+ public void writer(int c)
写出单个字符
+ public void writer(char[] cbuf)
写出字符数组
+ public void writer(char[] cbuf,int off,int len)
写出字符数组的某一部分。off：数组的开始索引；len：写出的字符个数。 
+ public void writer(String str)
写出字符串
+ public void writer(String str,int off,int len)
出字符串的某一部分。off：字符串的开始索引；len：写出的字符个数。
+ public void flush()
刷新该流的缓冲
+ public void close()
关闭此流

### 3.3 FileReader
+ FileReader(File file)
创建一个新的 FileReader ，给定要读取的File对象
+ FileReader(String fileName)
创建一个新的 FileReader ，给定要读取的文件的名称

### 3.4 FileWriter
+ FileWrite(File file)
创建一个新的 FileWriter，给定要读取的File对象
+ FIleWriter(String fileName)
创建一个新的 FileWriter，给定要读取的文件的名称
+ FileWriter(File file,boolean append)
创建一个新的 FileWriter，指明是否在现有文件末尾追加内容。

### 3.5 flush
+ 如果FileWriter不关闭输出流,那就无法写出字符到文件中,使用flush()可以刷新缓冲区

***

## 4. FileInputStream/FileOutputStream
适用于非文本文件
### 4.1 InputStream
+ public int read()
从输入流读取一个字节。返回读取的字节值。虽然读取了一个字节，但是会自动提升为int类型。如果已经到达流末尾，没有数据可读，则返回-1
+ public int read(byte[] b)
从输入流中读取一些字节数，并将它们存储到字节数组 b中 。每次最多读取b.length个字节。返回实际读取的字节个数。如果已到达流末尾，没有数据可读，则返回-1
+ public int read(byte[] b,int off,int len)
+ public void close()

### 4.2 OutputStream
+ public void write(int b)
将指定的字节输出流。虽然参数为int类型四个字节，但是只会保留一个字节的信息写出。
+ public void write(byte[] b)
+ public void wtite(byte[] b,int off,int len)
+ public void flush()
+ public void close()

### 4.3 FileInputStream
+ FileInputStream(File file)
+ FileInputStream(String name)

### 4.4 FileOutputStream
+ FileOutputStream(File file)
+ FIleOutputStream(String name)

***

## 5. 缓冲流
+ 为了提高读写速度

### 5.1 构造器
+ public BufferedInputStream(InputStream in)
+ public BufferedOutputStream(OutputStream out)
+ public BUfferedReader(Reader in)
+ public BufferedWriter(Writer out)

### 5.2 使用
```
//1. 造文件
File srcFile = new File(srcPath);
File destFile = new File(destPath);
//2. 造流
fis = new FileInputStream(srcFile);
fos = new FileOutputStream(destFile);
bis = new BufferedInputStream(fis);
bos = new BufferedOutputStream(fos);
```
+ 只需要关闭外面的流，内部的流会一同关闭

### 5.3 字符缓冲流特有方法
+ BufferedReader : public String readLine()
读一行文字
+ BufferedWriter : public void newLine()
写一行行分隔符,由系统属性定义符号

***

## 6. 转换流
### 6.1 InputStreamReader
+ InputStreamReader(InputStream in)
+ INputStreamReader(InputStream in,String charsetName)

### 6.2 OutputStreamWriter
+ OutputStreamWriter(OutputStream out)
+ OutputStreamWriter(OutputStream out,String charsetName)

***

## 7. 数据流、对象流
将内存中定义的变量（包括基本数据类型或引用数据类型）保存在文件中
### 7.1 数据流
+ DataOutPutStream
允许应用程序将基本数据类型、String类型的变量写入输出流中
+ DataInputStream
允许应用程序以与机器无关的方式从底层输入流中读取基本数据类型、String类型的变量。
+ DataInputStream的方法
byte readByte()
short readShort()
int readInt()
long readLong()
float readFloat()
double readDouble()
char readChar()
boolean readBoolean()
String readUTF()
void readFUlly(byte[] b)

### 7.2 对象流
+ ObjectInputStream
ObjectInputStream 对以前使用 ObjectOutputStream 写出的基本数据类型的数据和对象进行读入操作，保存在内存中。
+ ObjectOutputStream
将 Java 基本数据类型和对象写入字节输出流中。通过在流中使用文件可以实现Java各种基本数据类型的数据以及对象的持久存储。

### 7.3 ObjectOutputStream
**构造器**
+ public ObjectOutputStream(OutputStream out)
**方法**
+ public void writeBoolean(boolean val)
+ public void writeByte(int val)
+ public void writeShort(int val)
+ public void writeChar(int val)
+ public void writeInt(int val)
+ public void writeLong(long val)
+ public void writeFloat(float val)
+ public void writeDouble(double val)
+ public void writeUTF(String str)
+ public void writeObject(Object obj)
+ public void close()

### 7.4 ObjectInputStream
**构造器**
+ public ObjectInputStream(InputStream in)
**方法**
+ public boolean readBoolean();
+ public byte readByte()
+ public short readShort()
+ public char readChar()
+ public int readInt()
+ public long readLong()
+ public float readFloat()
+ public double readDouble()
+ public String readUTF()
+ public void readObject(Object obj)
+ public void close()

### 7.5 序列化与反序列化
+ 序列化 : 将对象保存在文件中,存储为二进制文件
+ 反序列化 : 将文件中的内容重新转化为对象

### 7.6 反序列化失败的问题
+ class找不到
+ class发生改变
+ 解决方法
使用 Serializable 接口指定序列版本号
```java
public class Employee implements Serializable {
    private static final long serialVersionUID = 1324234L; //增加serialVersionUID
    
    //其它结构：略
}
```

***

## 8. 其他流
### 8.1 标准输入输出流
+ System.in
+ System.out
+ 重定向
public static void setIn(InputStream in)
public static void setOut(OutputStream out)

### 8.2 打印流
+ PrintStream
















